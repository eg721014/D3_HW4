<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <title>d3-start</title>
    <script src="https://d3js.org/d3.v3.js"></script>
    
</head>
<body>
   <h3>練習一</h3>
   <svg id="invoice" width="600" height="250"></svg>
        <script>
        d3.json("invoice-taipei.json",function(dataSet) {
         var body = d3.select("body");
         var count = 0;
         for(var i=0; i < dataSet.length; i++) {
            if(parseInt(dataSet[i].amount) > 1000000000 && dataSet[i].date === "2016/8/1" && dataSet[i].cid ==="A") {
              body.select("#invoice").append("text").attr({
                x: 0,
                y: 20 + 20 * count,
                "font-size": 12
              }).text(dataSet[i].industry);
                
              d3.select("#invoice")
              .append("rect")
              .attr({
                 x: 200,
                 y: 10 + 20 * count,
                 width: dataSet[i].amount / 100000000,
                 height: 10,
                 fill: "red"
              });
              count++;
            }
            
         }
        });
        </script>
        <h3>練習二</h3>
         <div id="grade" height= "800" width="600"></div>
        <script>
    var arr = [85, 60, 99, 49, 77, 82]; 
    bind(arr);
    render();
    function bind(data){
        var selection = d3.select("body")
            .selectAll("div")
            .data(data);
        selection.enter().append("div");
        selection.exit().remove();
    }
     function render(){
        d3.selectAll("div").text(function(d,i){
            return i+":"+d
        });   
        d3.selectAll("div").style({
            color: function(d){
                if(d<70){
                return "red";
                }
                else{
                    return "black";
                }
            }
        });
        }

</script>
<h3>練習三</h3>
 <input type="button" value="new" onclick="update()">
    <svg id="three" width ="700" height="300"></svg>
    <script>
        var h=300;
        var w=700;
        var p=50;
        
        var arr=[80,76,96,35,88,69];
        
        svg(w,h,p);
        bind(arr);
        render(w,h,p);
        bind2(arr);
        render2(w,h,p);
        
        function svg(w,h,p){
            d3.select("body").append("svg").attr({
                width: w,
                height:h
            })
        }
        function update(){
            var num = random(10,100);
            arr.push(num);
            bind(arr);
            render(w,h,p);
            bind2(arr);
            render2(w,h,p);
        }
        function bind(data){
            var selection = d3.select("#three")
                                .selectAll("rect")
                                .data(data);
            selection.enter().append("rect");
            selection.exit().remove();
        }
        function render(w,h,p){
            d3.selectAll("#three rect").attr({
                x:function(d,i){return p+45*i;},
                y:function(d){return h-p-d;},
                width:40,
                height: function(d){return d;},
                fill: function(d){
                    if(d<70){
                        return "red";
                    }
                    else{
                        return "blue";
                    }
                    
                },
            })
        }
        function bind2(data){
            var selection = d3.select("#three")
                                .selectAll("text")
                                .data(data);
            selection.enter().append("text");
            selection.exit().remove();
        }
         function render2(w,h,p){
            d3.selectAll("#three text").attr({
                x:function(d,i){return 12+p+45*i;},
                y:function(d){return h-p+15;},
                fill: "black"
            }).text(function(d){return d;})
         }
        function random (n,m){
            return Math.ceil(Math.random()*(m-n)+n);
        }
    </script>
</body>
</html>